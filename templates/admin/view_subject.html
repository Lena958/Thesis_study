<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CCIS</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/view_subject.css') }}">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" />
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/brand.png') }}">
  <style>
    /* Close button style */
    .close {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
    }

    /* Disabled button style */
    .btn-disabled {
      background-color: #ccc !important;
      color: #000 !important; /* improved contrast */
      cursor: not-allowed !important;
      border: 1px solid #aaa !important;
      pointer-events: none;
    }

    /* Basic dialog styling */
    dialog {
      border: none;
      border-radius: 5px;
      padding: 1.5rem;
      max-width: 400px;
      width: 90%;
    }

    dialog::backdrop {
      background: rgba(0,0,0,0.5);
    }
  </style>
</head>
<body>
    <div class="topbar">
        <h1>College of Computing and Information Sciences</h1>

        <div class="topbar-profile">
            {% if instructor_image %}
            <img src="{{ url_for('static', filename='uploads/' + instructor_image) }}"
                alt="Profile" class="profile-pic" />
            {% else %}
            <i class="fas fa-user-circle profile-icon"></i>
            {% endif %}

            <button type="button" class="logout-btn" title="Logout" onclick="openLogoutModal(event)">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-user">
            <img src="{{ url_for('static', filename='images/brand.png') }}" 
                 alt="CCISS Logo" class="sidebar-logo">
            {% if instructor_name %}
                <p><strong>{{ instructor_name }}</strong></p>
            {% else %}
                <p><em>Instructor name not found</em></p>
            {% endif %}
        </div>
        <a href="{{ url_for('dashboard.admin_dashboard') }}"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
        <a href="{{ url_for('admin.profile') }}"><i class="fas fa-user"></i> Profile</a>
        <a href="{{ url_for('instructors.list_instructors') }}"><i class="fas fa-chalkboard-teacher"></i> Instructors</a>
        <a href="{{ url_for('courses.list_courses') }}"><i class="fas fa-book"></i> Courses</a>
        <a href="{{ url_for('rooms.list_rooms') }}"><i class="fas fa-door-open"></i> Rooms</a>
        <a href="{{ url_for('subjects.list_subjects') }}"><i class="fas fa-book"></i> CCISS Loader</a>
        <a href="{{ url_for('auto_scheduler.auto_scheduler_home') }}"><i class="fas fa-cogs"></i> Auto-Scheduler</a>
        <a href="{{ url_for('schedules.list_schedules') }}"><i class="fas fa-calendar-alt"></i> Schedules</a>
        <a href="{{ url_for('conflicts.list_conflicts') }}"><i class="fas fa-exclamation-triangle"></i> Conflicts</a>     
    </div>

    <div class="main-content">
        <div class="main-form">
            <h2>Instructor's Assigned Load Details</h2>

            <p><strong>Instructor:</strong> {{ subject.instructor_name or "Unassigned" }}</p>
            <p><strong>Course Code:</strong> {{ subject.code }}</p>
            <p><strong>Course Name:</strong> {{ subject.name }}</p>
            <p><strong>Program / Year Level / Section:</strong> 
                {{ subject.course or "N/A" }} {{ subject.year_level or "N/A" }}{{ subject.section or "N/A" }}
            </p>
            <p><strong>Units:</strong> {{ subject.units }}</p>

            <a href="{{ url_for('subjects.list_subjects') }}" class="btn btn-secondary">Back</a>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <dialog id="logoutModal">
        <form method="dialog">
            <button type="button" class="close" onclick="closeLogoutModal()" aria-label="Close Logout Modal">&times;</button>
            <h3>Confirm Logout</h3>
            <p>Are you sure you want to logout?</p>
            <form id="logoutForm" method="GET" action="{{ url_for('logout') }}">
                <button type="submit" class="btn btn-danger">Logout</button>
                <button type="button" class="btn btn-secondary" onclick="closeLogoutModal()">Cancel</button>
            </form>
        </form>
    </dialog>

    <script>
        function openLogoutModal(event) {
            event.preventDefault();
            const modal = document.getElementById('logoutModal');
            if (typeof modal.showModal === "function") {
                modal.showModal();
                modal.querySelector('button').focus();
            } else {
                alert("Your browser does not support the dialog element.");
            }
        }

        function closeLogoutModal() {
            const modal = document.getElementById('logoutModal');
            if (typeof modal.close === "function") {
                modal.close();
            }
        }

        // Close modal on click outside
        globalThis.addEventListener('click', function(event) {
            const modal = document.getElementById('logoutModal');
            if (event.target === modal) {
                modal.close();
            }
        });
    </script>
</body>
</html>
